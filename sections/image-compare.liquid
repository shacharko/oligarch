

<div
  data-section-id="{{ section.id }}"
  data-section-type="image-compare"
  class="
    image-compare
    image-compare--{{ section.settings.aspect_ratio }}
    image-compare--{{ section.settings.reveal_direction }}
    image-compare--image-{{ section.settings.image_position }}
    image-compare--justify-{{ section.settings.text_alignment }}
    section
    section--divider-{{ section.settings.divider_style }}
    {{ section.settings.section_padding }}
    {% if settings.enable_section_animations and section.settings.enable_animation %}
      animation
      animation--image-compare
    {% endif %}
  "
  style="
    --slider-color: {{ section.settings.slider_color }};
    --slider-arrows-color: {{ section.settings.slider_arrows_color }};
    --image-max-width: {{ section.settings.image_max_width }}px;
    --text-alignment: {{ section.settings.text_alignment }};
  ";
>
  <div class="image-compare__inner">
    <div class="image-compare__text-container">
      <div class="image-compare__text-container-inner">
        <div class="section-introduction animation--section-introduction">
          {%- unless section.settings.heading == blank -%}
            <{{ section.settings.heading_tag }} class="ff-heading {{ section.settings.heading_font_class }} section-introduction__heading">
              {{ section.settings.heading }}
            </{{ section.settings.heading_tag }}>
          {%- endunless -%}

          {%- unless section.settings.subheading == blank -%}
            <div class="ff-body fs-body-100 rte section-introduction__subheading">
              {{ section.settings.subheading }}
            </div>
          {%- endunless -%}

          {%-
            render 'button-block',
            wrapper_class: "section-introduction__button",
            link: section.settings.link,
            label: section.settings.link_text,
            button_style: section.settings.button_style,
            button_alignment: section.settings.text_alignment,
          -%}
        </div>
      </div>
    </div>

    <div class="image-compare__image-container">
      <div class="image-compare__image-container-inner">
        {% for block in section.blocks %}
          {% liquid
            assign overlay_opacity = block.settings.overlay_opacity | divided_by: 100.0
            assign text_position = block.settings.text_position | split: "_"
            assign horizontal_position = text_position | first
            assign vertical_position = text_position | last

            case block.settings.filter_effect
              when 'blur'
                assign filter_amount = block.settings.filter_amount | divided_by: 25.0 | append: 'px'
              when 'brightness' or 'contrast' or 'saturate'
                assign filter_amount = block.settings.filter_amount | divided_by: 50.0
              when 'grayscale' or 'invert' or 'sepia'
                assign filter_amount = block.settings.filter_amount | divided_by: 100.0
            endcase
          %}
          <div
            class="
              image-compare__image-wrapper
              {% if block.settings.filter_effect != 'none' -%}
                image-compare__image--{{ block.settings.filter_effect }}
              {%- endif -%}
            "
            style="
              --overlay-background: {{ block.settings.color_overlay }};
              {% if block.settings.color_overlay_gradient != blank -%}
                --overlay-background-gradient: {{ block.settings.color_overlay_gradient }};
              {%- endif %}
              --overlay-opacity: {{ overlay_opacity }};
              --filter-amount: {{ filter_amount }};
              --text-horizontal-position: {{ horizontal_position }};
              --text-vertical-position: {{ vertical_position }};
              --color-text: {{ block.settings.text_color }};
              --color-text-container: {{ block.settings.text_container_color }};
            "
          >
            {%- if forloop.first -%}
              {% assign placeholder_name = 'collection-1' %}
              <div class="image-compare__image-before" {{ block.shopify_attributes }}>
            {%- else -%}
              {% assign placeholder_name = 'collection-4' %}
              <div class="image-compare__image-after" {{ block.shopify_attributes }}>
            {%- endif -%}
              {%
                render 'image' with
                image: block.settings.image,
                wrapper_class: 'image-compare__image',
                aspect_ratio: section.settings.aspect_ratio,
                focal_point: block.settings.focal_point,
                placeholder_name: placeholder_name,
                include_placeholder: true,
                placeholder_natural_fallback_ratio: 'landscape'
                sizes: "(min-width: 960px) calc(100vw - calc(2 * 3.3vw)), calc(100vw - calc(2 * clamp(18px, 3.3vw, 3.3vw)))",
                animate: true
              %}
                <div class="image-compare__overlay"></div>
                {%- if block.settings.show_label -%}
                  <div class="image-compare__label-container-wrapper animation--label">
                    <div class="image-compare__label-container">
                      <div class="image-compare__label-container-inner section-blocks animation--section-blocks">
                        {%- unless block.settings.text == blank -%}
                          <div class="image-compare__label-container-text ff-body fs-body-75 fs-body-100-ns {{ block.settings.text_font_class }} section-blocks__text">
                            {{ block.settings.text }}
                          </div>
                        {%- endunless -%}
                      </div>
                    </div>
                  </div>
                {%- endif -%}
              </div>
          </div>
        {% endfor %}
      </div>
      {%- if section.blocks.size > 0 -%}
        <input
          type="range"
          value="50"
          step="any"
          aria-label="Percentage of after photo shown"
          class="image-compare__slider"
          orient="{% # for Firefox %}{{ section.settings.reveal_direction }}"
        >
        <div class="image-compare__slider-line" aria-hidden="true"></div>
        <div class="image-compare__slider-button" aria-hidden="true">
          <div class="image-compare__slider-button-arrows">
            <div class="image-compare__slider-button-arrow image-compare__slider-button-arrow-before">{% render 'icon' with icon: 'chevron-small' %}</div>
            <div class="image-compare__slider-button-arrow image-compare__slider-button-arrow-after">{% render 'icon' with icon: 'chevron-small' %}</div>
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "t:sections.image_compare.name",
  "tag": "section",
  "disabled_on": {
    "groups": [
      "header",
      "custom.overlay"
    ]
  },
  "settings": [
    {
      "type": "select",
      "id": "image_position",
      "label": "t:sections.image_compare.settings.image_position.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.image_compare.settings.image_position.options.left"
        },
        {
          "value": "right",
          "label": "t:sections.image_compare.settings.image_position.options.right"
        },
        {
          "value": "below",
          "label": "t:sections.image_compare.settings.image_position.options.below"
        }
      ],
      "default": "below"
    },
    {
      "type": "select",
      "id": "aspect_ratio",
      "label": "t:sections.image_compare.settings.aspect_ratio.label",
      "options": [
        {
          "value": "square",
          "label": "t:shared.options.aspect_ratio.square"
        },
        {
          "value": "portrait",
          "label": "t:shared.options.aspect_ratio.portrait"
        },
        {
          "value": "landscape",
          "label": "t:shared.options.aspect_ratio.landscape"
        }
      ],
      "default": "landscape"
    },
    {
      "type": "select",
      "id": "reveal_direction",
      "label": "t:sections.image_compare.settings.reveal_direction.label",
      "options": [
        {
          "value": "horizontal",
          "label": "t:sections.image_compare.settings.reveal_direction.options.horizontal"
        },
        {
          "value": "vertical",
          "label": "t:sections.image_compare.settings.reveal_direction.options.vertical"
        }
      ],
      "default": "horizontal"
    },
    {
      "type": "range",
      "id": "image_max_width",
      "label": "t:sections.image_compare.settings.image_max_width.label",
      "min": 300,
      "max": 1400,
      "step": 100,
      "unit": "px",
      "default": 1400
    },
    {
      "type": "color",
      "id": "slider_color",
      "label": "t:sections.image_compare.settings.slider_color.label",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "slider_arrows_color",
      "label": "t:sections.image_compare.settings.slider_arrows_color.label",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "t:sections.image_compare.settings.text.header.content"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "t:shared.settings.alignment_horizontal.text.label",
      "options": [
        {
          "value": "left",
          "label": "t:shared.options.alignment.horizontal.left"
        },
        {
          "value": "center",
          "label": "t:shared.options.alignment.horizontal.center"
        },
        {
          "value": "right",
          "label": "t:shared.options.alignment.horizontal.right"
        }
      ],
      "default": "center"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.image_compare.settings.text.heading.label",
      "default": "t:sections.image_compare.settings.text.heading.default"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "t:shared.settings.heading_tag.heading.label",
      "options": [
        {
          "value": "h2",
          "label": "t:shared.settings.heading_tag.options.h2"
        },
        {
          "value": "h3",
          "label": "t:shared.settings.heading_tag.options.h3"
        },
        {
          "value": "h4",
          "label": "t:shared.settings.heading_tag.options.h4"
        },
        {
          "value": "h5",
          "label": "t:shared.settings.heading_tag.options.h5"
        },
        {
          "value": "h6",
          "label": "t:shared.settings.heading_tag.options.h6"
        }
      ],
      "default": "h2"
    },
    {
      "type": "paragraph",
      "content": "t:shared.settings.heading_tag.heading.info"
    },
    {
      "type": "select",
      "id": "heading_font_class",
      "label": "t:shared.settings.heading_font_class.label",
      "options": [
        {
          "value": "fs-heading-3-base",
          "label": "t:shared.settings.heading_font_class.options.small"
        },
        {
          "value": "fs-heading-2-base",
          "label": "t:shared.settings.heading_font_class.options.medium"
        },
        {
          "value": "fs-heading-1-base",
          "label": "t:shared.settings.heading_font_class.options.large"
        }
      ],
      "default": "fs-heading-3-base"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "t:sections.image_compare.settings.text.subheading.label",
      "default": "t:sections.image_compare.settings.text.subheading.default"
    },
    {
      "type": "header",
      "content": "t:sections.image_compare.settings.button.header.content"
    },
    {
      "type": "url",
      "id": "link",
      "label": "t:shared.settings.button_link.label"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "t:shared.settings.button_link_text.label"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "t:shared.settings.button_style.label",
      "options": [
        {
          "value": "btn--primary",
          "label": "t:shared.settings.button_style.options.solid"
        },
        {
          "value": "btn--secondary",
          "label": "t:shared.settings.button_style.options.outline"
        },
        {
          "value": "btn--callout",
          "label": "t:shared.settings.button_style.options.text"
        }
      ],
      "default": "btn--secondary"
    },
    {
      "type": "header",
      "content": "t:shared.settings.section_style.header.content"
    },
    {
      "type": "checkbox",
      "id": "enable_animation",
      "label": "t:shared.settings.section_style.enable_animation.label",
      "default": true,
      "info": "t:shared.settings.section_style.enable_animation.info"
    },
    {
      "type": "select",
      "id": "divider_style",
      "label": "t:shared.settings.section_style.divider_style.label",
      "options": [
        {
          "value": "none",
          "label": "t:shared.settings.section_style.divider_style.options.none"
        },
        {
          "value": "solid",
          "label": "t:shared.settings.section_style.divider_style.options.solid"
        }
      ],
      "default": "none"
    },
    {
      "type": "select",
      "id": "section_padding",
      "label": "t:shared.settings.section_style.section_padding.label",
      "options": [
        {
          "value": "section--vertical-padding-none",
          "label": "t:shared.settings.section_style.section_padding.options.none"
        },
        {
          "value": "section--vertical-padding-top-bottom",
          "label": "t:shared.settings.section_style.section_padding.options.both"
        },
        {
          "value": "section--vertical-padding-top-only",
          "label": "t:shared.settings.section_style.section_padding.options.top"
        },
        {
          "value": "section--vertical-padding-bottom-only",
          "label": "t:shared.settings.section_style.section_padding.options.bottom"
        }
      ],
      "default": "section--vertical-padding-top-bottom"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "t:sections.image_compare.blocks.image.name",
      "limit": 2,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.image_compare.blocks.image.settings.image.label"
        },
        {
          "type": "select",
          "id": "focal_point",
          "label": "t:shared.settings.focal_point.image.default.label",
          "options": [
            {
              "value": "image_presentation",
              "label": "t:shared.options.focal_point.image_presentation"
            },
            {
              "value": "center",
              "label": "t:shared.options.focal_point.center"
            },
            {
              "value": "top",
              "label": "t:shared.options.focal_point.top"
            },
            {
              "value": "bottom",
              "label": "t:shared.options.focal_point.bottom"
            },
            {
              "value": "left",
              "label": "t:shared.options.focal_point.left"
            },
            {
              "value": "right",
              "label": "t:shared.options.focal_point.right"
            }
          ],
          "default": "image_presentation"
        },
        {
          "type": "header",
          "content": "t:sections.image_compare.blocks.image.settings.graphics.header.content"
        },
        {
          "type": "select",
          "id": "filter_effect",
          "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.label",
          "options": [
            {
              "value": "none",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.none"
            },
            {
              "value": "blur",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.blur"
            },
            {
              "value": "brightness",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.brightness"
            },
            {
              "value": "contrast",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.contrast"
            },
            {
              "value": "grayscale",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.grayscale"
            },
            {
              "value": "invert",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.invert"
            },
            {
              "value": "saturate",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.saturate"
            },
            {
              "value": "sepia",
              "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_effect.options.sepia"
            }
          ]
        },
        {
          "type": "range",
          "id": "filter_amount",
          "label": "t:sections.image_compare.blocks.image.settings.graphics.filter_amount.label",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 100
        },
        {
          "type": "color",
          "id": "color_overlay",
          "label": "t:shared.settings.overlay.overlay.label",
          "default": "#000000"
        },
        {
          "type": "color_background",
          "id": "color_overlay_gradient",
          "label": "t:shared.settings.overlay.overlay_gradient.label"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "t:shared.settings.overlay.overlay_opacity.label",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 40
        },
        {
          "type": "header",
          "content": "t:sections.image_compare.blocks.image.settings.label.header.content"
        },
        {
          "type": "checkbox",
          "id": "show_label",
          "label": "t:sections.image_compare.blocks.image.settings.label.show_label.label",
          "default": true
        },
        {
          "type": "text",
          "id": "text",
          "label": "t:sections.image_compare.blocks.image.settings.label.text.label"
        },
        {
          "type": "select",
          "id": "text_position",
          "label": "t:sections.image_compare.blocks.image.settings.label.text_position.label",
          "options": [
            {
              "value": "flex-start_flex-start",
              "label": "t:shared.options.alignment.full.top_left"
            },
            {
              "value": "center_flex-start",
              "label": "t:shared.options.alignment.full.top_center"
            },
            {
              "value": "flex-end_flex-start",
              "label": "t:shared.options.alignment.full.top_right"
            },
            {
              "value": "flex-start_center",
              "label": "t:shared.options.alignment.full.middle_left"
            },
            {
              "value": "flex-end_center",
              "label": "t:shared.options.alignment.full.middle_right"
            },
            {
              "value": "flex-start_flex-end",
              "label": "t:shared.options.alignment.full.bottom_left"
            },
            {
              "value": "center_flex-end",
              "label": "t:shared.options.alignment.full.bottom_center"
            },
            {
              "value": "flex-end_flex-end",
              "label": "t:shared.options.alignment.full.bottom_right"
            }
          ],
          "default": "flex-start_flex-start"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "t:sections.image_compare.blocks.image.settings.label.text_color.label",
          "default": "#000000"
        },
        {
          "type": "color",
          "id": "text_container_color",
          "label": "t:sections.image_compare.blocks.image.settings.label.text_container_color.label",
          "default": "#FFFFFF"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.image_compare.presets.name",
      "blocks": [
        {
          "type": "image",
          "settings": {
            "text": "Before",
            "text_position": "flex-start_flex-start"
          }
        },
        {
          "type": "image",
          "settings": {
            "text": "After",
            "text_position": "flex-end_flex-end"
          }
        }
      ]
    }
  ]
}
{% endschema %}
